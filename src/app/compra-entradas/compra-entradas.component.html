<!-- Hero Section Moderno -->
<section class="hero-section" *ngIf="featuredMovies.length > 0 && currentMovie">
  <div class="hero-slider">
    <!-- Slide único con contenido dinámico -->
    <div class="hero-slide active">
      <div class="hero-background">
        <img
          [src]="
            'https://image.tmdb.org/t/p/original/' + currentMovie.backdrop_path
          "
          [alt]="currentMovie.title"
          class="hero-bg-image"
          *ngIf="currentMovie.backdrop_path"
        />
        <div class="hero-fallback-bg" *ngIf="!currentMovie.backdrop_path"></div>

        <!-- Overlay con gradiente -->
        <div class="hero-overlay"></div>
      </div>

      <div class="hero-content">
        <div class="hero-container">
          <div class="hero-info">
            <div class="hero-badges">
              <span class="badge-rating">
                <i class="fas fa-star"></i>
                {{ currentMovie.vote_average | number : "1.1" }}
              </span>
            </div>

            <h1 class="hero-title">{{ currentMovie.title }}</h1>
            <p class="hero-description">{{ currentMovie.overview }}</p>

            <div class="hero-details">
              <span class="detail-item">
                <i class="fas fa-clock"></i>
                120 min
              </span>
              <span class="detail-item">
                <i class="fas fa-film"></i>
                {{ getMovieGenres(currentMovie.genre_ids) }}
              </span>
              <span class="detail-item">
                <i class="fas fa-star"></i>
                {{ currentMovie.vote_average | number : "1.1" }}
              </span>
            </div>

            <div class="hero-actions">
              <button
                class="btn-primary-hero"
                (click)="verDetalles(currentMovie.id)"
              >
                <i class="fas fa-ticket-alt"></i>
                Comprar Entradas
              </button>

              <button class="btn-secondary-hero" (click)="watchTrailer()">
                <i class="fas fa-play"></i>
                Ver Trailer
              </button>

              <button
                class="btn-favorite-hero"
                (click)="toggleFavorito(currentMovie)"
                [class.active]="esFavorito(currentMovie.id)"
              >
                <i class="fas fa-heart"></i>
              </button>
            </div>
          </div>

          <div class="hero-poster">
            <img
              [src]="
                'https://image.tmdb.org/t/p/w500/' + currentMovie.poster_path
              "
              [alt]="currentMovie.title"
              class="featured-poster"
              *ngIf="currentMovie.poster_path"
            />
            <div class="poster-glow"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Indicadores de slides -->
    <div class="hero-indicators" *ngIf="featuredMovies.length > 1">
      <button
        *ngFor="let movie of featuredMovies; let i = index"
        class="indicator"
        [class.active]="currentSlide === i"
        (click)="goToSlide(i)"
      ></button>
    </div>
  </div>

  <!-- Navegación del slider -->
  <button
    class="hero-nav prev"
    (click)="previousSlide()"
    *ngIf="featuredMovies.length > 1"
  >
    <i class="fas fa-chevron-left"></i>
  </button>
  <button
    class="hero-nav next"
    (click)="nextSlide()"
    *ngIf="featuredMovies.length > 1"
  >
    <i class="fas fa-chevron-right"></i>
  </button>
</section>

<!-- Fallback loading hero -->
<section class="hero-section hero-loading" *ngIf="featuredMovies.length === 0">
  <div class="hero-content">
    <div class="hero-container">
      <div class="hero-info">
        <div class="loading-content">
          <h1 class="hero-title">¡Bienvenido a CinemaLand!</h1>
          <p class="hero-description">
            Cargando las mejores películas para ti...
          </p>
          <div class="loading-spinner">
            <i class="fas fa-film fa-spin"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Panel lateral de favoritos -->
<div class="panel-favoritos" [class.abierto]="favoritosAbierto">
  <div class="favoritos-header">
    <h2 class="titulofav">Tus Favoritas</h2>
  </div>
  <div class="favoritos-content">
    <ul class="favoritos-lista">
      <li *ngFor="let pelicula of peliculasfavoritas" class="pelicula-card-fav">
        <div class="favorito-container">
          <img
            [src]="'https://image.tmdb.org/t/p/w200/' + pelicula.poster_path"
            pel
            alt="Poster"
            class="favorito-poster"
          />
          <h4 class="favorito-titulo">{{ pelicula.title }}</h4>
        </div>
        <div class="favorito-actions">
          <button (click)="verDetalles(pelicula.id)" class="btn-ver-detalles">
            Ver
          </button>
          <button
            (click)="eliminarDeFavoritos(pelicula.id)"
            class="btn-eliminar"
          >
            ❌
          </button>
        </div>
      </li>
    </ul>
    <button (click)="Borrarlistacompleta()" class="boton-limpiar">
      Borrar Favoritos
    </button>
  </div>
</div>

<div class="compra-container" [class.con-panel-abierto]="favoritosAbierto">
  <!-- Sección de películas en cartelera -->
  <section class="cartelera-section">
    <div class="section-header">
      <h2 class="section-title">DESTACADAS en Cartelera</h2>
      <p class="section-subtitle">Las películas destacadas en nuestros cines</p>

      <!-- Sistema de filtros -->
      <div class="filtros-container">
        <div class="filtros-row">
          <div class="filtro-grupo">
            <label class="filtro-label">Formato</label>
            <div class="filtro-opciones">
              <button
                class="filtro-btn"
                [class.active]="filtroFormato === 'todos'"
                (click)="setFiltroFormato('todos')"
              >
                Todos
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroFormato === '2D'"
                (click)="setFiltroFormato('2D')"
              >
                2D
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroFormato === '3D'"
                (click)="setFiltroFormato('3D')"
              >
                3D
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroFormato === 'IMAX'"
                (click)="setFiltroFormato('IMAX')"
              >
                IMAX
              </button>
            </div>
          </div>

          <div class="filtro-grupo">
            <label class="filtro-label">Idioma</label>
            <div class="filtro-opciones">
              <button
                class="filtro-btn"
                [class.active]="filtroIdioma === 'todos'"
                (click)="setFiltroIdioma('todos')"
              >
                Todos
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroIdioma === 'español'"
                (click)="setFiltroIdioma('español')"
              >
                Español
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroIdioma === 'ingles'"
                (click)="setFiltroIdioma('ingles')"
              >
                Inglés
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroIdioma === 'subtitulado'"
                (click)="setFiltroIdioma('subtitulado')"
              >
                Subtitulado
              </button>
            </div>
          </div>

          <div class="filtro-grupo">
            <label class="filtro-label">Edad</label>
            <div class="filtro-opciones">
              <button
                class="filtro-btn"
                [class.active]="filtroEdad === 'todos'"
                (click)="setFiltroEdad('todos')"
              >
                Todos
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroEdad === 'ATP'"
                (click)="setFiltroEdad('ATP')"
              >
                ATP
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroEdad === '+13'"
                (click)="setFiltroEdad('+13')"
              >
                +13
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroEdad === '+16'"
                (click)="setFiltroEdad('+16')"
              >
                +16
              </button>
              <button
                class="filtro-btn"
                [class.active]="filtroEdad === '+18'"
                (click)="setFiltroEdad('+18')"
              >
                +18
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="peliculas-grid">
      <div
        *ngFor="let pelicula of getEstrenosFiltrados(); let i = index"
        class="pelicula-card-modern"
        [style.display]="
          mostrarTodasLasPeliculas || i < peliculasMostradas ? 'block' : 'none'
        "
      >
        <div class="card-image-container">
          <img
            [src]="'https://image.tmdb.org/t/p/w400/' + pelicula.poster_path"
            alt="{{ pelicula.title }}"
            class="card-poster"
          />
          <div class="card-overlay">
            <div class="card-rating">
              <i class="fas fa-star"></i>
              {{ pelicula.vote_average | number : "1.1" }}
            </div>
            <div class="card-destacada-icon" *ngIf="pelicula.esDestacada">
              <i class="fas fa-award"></i>
            </div>
            <button
              class="btn-favorite-card"
              (click)="toggleFavorito(pelicula)"
              [class.active]="esFavorito(pelicula.id)"
            >
              <i class="fas fa-heart"></i>
            </button>
          </div>
        </div>

        <div class="card-content">
          <div class="card-info">
            <h4 class="card-title">{{ pelicula.title }}</h4>
            <div class="card-meta">
              <span class="card-genre">
                <i class="fas fa-film"></i>
                {{ getMovieGenres(pelicula.genre_ids) }}
              </span>
              <span
                class="card-badge"
                [class.estreno]="
                  getTipoPelicula(pelicula.release_date) === 'ESTRENO'
                "
              >
                {{ getTipoPelicula(pelicula.release_date) }}
              </span>
              <span
                class="card-age-rating"
                [class]="
                  'age-' +
                  (pelicula.clasificacionEdad || 'ATP')
                    .toLowerCase()
                    .replace('+', 'plus')
                "
              >
                {{ pelicula.clasificacionEdad || "ATP" }}
              </span>
            </div>
          </div>
          <div class="card-actions">
            <button
              class="btn-icon-card"
              (click)="verDetalles(pelicula.id)"
              title="Ver detalles completos"
            >
              <i class="fas fa-info-circle"></i>
            </button>
            <button
              class="btn-primary-card"
              (click)="comprarEntradasPelicula(pelicula.id)"
              title="Comprar entradas"
            >
              <i class="fas fa-ticket-alt"></i>
              COMPRAR ENTRADAS
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Botón Ver más -->
    <div
      class="ver-mas-container"
      *ngIf="
        !mostrarTodasLasPeliculas &&
        getEstrenosFiltrados().length > peliculasMostradas
      "
    >
      <button class="btn-ver-mas" (click)="verMasPeliculas()">
        <i class="fas fa-plus-circle"></i>
        Ver más películas
      </button>
    </div>
  </section>

  <!-- Sección Disfruta CinemaLand -->
  <section class="disfruta-section">
    <div class="section-header">
      <h2 class="section-title">Disfruta CinemaLand</h2>
      <p class="section-subtitle">
        Descubre todas las experiencias que tenemos para ti
      </p>
    </div>

    <div class="carousel-container">
      <div class="carousel-wrapper">
        <div
          class="carousel-track"
          [style.transform]="'translateX(' + -currentCarouselSlide * 25 + '%)'"
        >
          <!-- Slide 1: Ofertas especiales -->
          <div class="carousel-slide">
            <div class="promo-card ofertas">
              <div class="promo-icon">
                <i class="fas fa-percentage"></i>
              </div>
              <h3 class="promo-title">Ofertas Especiales</h3>
              <p class="promo-description">
                Hasta 30% de descuento en entradas para funciones matinée
              </p>
              <ul class="promo-list">
                <li><i class="fas fa-clock"></i> Matinée antes de las 16:00</li>
                <li><i class="fas fa-users"></i> Descuentos grupales</li>
                <li>
                  <i class="fas fa-birthday-cake"></i> Promociones cumpleañeros
                </li>
              </ul>
              <button class="promo-btn">Ver Ofertas</button>
            </div>
          </div>

          <!-- Slide 2: Características sociales -->
          <div class="carousel-slide">
            <div class="promo-card social">
              <div class="promo-icon">
                <i class="fas fa-share-alt"></i>
              </div>
              <h3 class="promo-title">CinemaLand Social</h3>
              <p class="promo-description">
                Comparte tu experiencia y conecta con otros cinéfilos
              </p>
              <ul class="promo-list">
                <li>
                  <i class="fas fa-heart"></i> Guarda tus películas favoritas
                </li>
                <li><i class="fas fa-star"></i> Califica y reseña</li>
                <li><i class="fas fa-comments"></i> Únete a las discusiones</li>
              </ul>
              <button class="promo-btn">Únete Ahora</button>
            </div>
          </div>

          <!-- Slide 3: Accesibilidad -->
          <div class="carousel-slide">
            <div class="promo-card accesibilidad">
              <div class="promo-icon">
                <i class="fas fa-wheelchair"></i>
              </div>
              <h3 class="promo-title">Cine Para Todos</h3>
              <p class="promo-description">
                Instalaciones completamente accesibles
              </p>
              <ul class="promo-list">
                <li>
                  <i class="fas fa-wheelchair"></i> Acceso para sillas de ruedas
                </li>
                <li>
                  <i class="fas fa-deaf"></i> Subtítulos y audio descriptivo
                </li>
                <li><i class="fas fa-eye"></i> Asientos prioritarios</li>
              </ul>
              <button class="promo-btn">Más Info</button>
            </div>
          </div>

          <!-- Slide 4: Peli Random -->
          <div class="carousel-slide">
            <div class="promo-card peli-random">
              <div class="promo-icon">
                <i class="fas fa-dice"></i>
              </div>
              <h3 class="promo-title">Peli Random</h3>
              <p class="promo-description">
                ¡Deja que el destino elija tu próxima película!
              </p>
              <ul class="promo-list">
                <li>
                  <i class="fas fa-magic"></i> Recomendaciones personalizadas
                </li>
                <li><i class="fas fa-surprise"></i> Descubre nuevos géneros</li>
                <li><i class="fas fa-gift"></i> Sorpresas especiales</li>
              </ul>
              <button class="promo-btn" (click)="irAPeliRandom()">
                Probar Suerte
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Controles del carousel -->
      <button class="carousel-btn prev" (click)="previousCarouselSlide()">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="carousel-btn next" (click)="nextCarouselSlide()">
        <i class="fas fa-chevron-right"></i>
      </button>

      <!-- Indicadores del carousel -->
      <div class="carousel-indicators">
        <button
          *ngFor="let slide of carouselSlides; let i = index"
          class="carousel-indicator"
          [class.active]="currentCarouselSlide === i"
          (click)="goToCarouselSlide(i)"
        ></button>
      </div>
    </div>
  </section>
</div>
